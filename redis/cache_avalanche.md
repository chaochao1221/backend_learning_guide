# 缓存雪崩及解决方案

### 定义：缓存雪崩是指缓存在某一个时间段大面积的失效，后面的请求都会落到数据库上，造成数据库短时间内承受大量请求而崩掉。（其实集中过期，倒不是非常致命，比较致命的是缓存服务器某个节点宕机或断网。因为自然形成的缓存雪崩，一定是在某个时间段集中创建缓存，这个时候，数据库也是可以顶住压力的，无非就是对数据库产生周期性的压力而已。而缓存服务器节点的宕机或断网，对数据库服务器造成的压力是不可预知的，很有可能瞬间就把数据库压垮。）

### 解决方案：

```
1、redis高可用（搭建 redis 集群）。
2、限流降级（在缓存失效后，通过加锁或者队列来控制读数据库写缓存的线程数量。比如对某个 key 只允许一个线程查询数据和写缓存，其他线程等待）。
3、数据预热（在正式部署之前，把可能的数据先预先访问一遍，这样部分可能大量访问的数据就会加载到缓存中。在即将发生大并发访问前手动触发加载缓存
不同的 key，设置不同的过期时间，让缓存失效的时间尽量均匀）。
```
